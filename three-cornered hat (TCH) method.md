# three-cornered hat (TCH) method

> TCH法可用于在数据真实值未知的情况下，估计3种及3种以上序列的不确定性。参与计算的序列越多，该方法也越稳健。因此，本研究中我们除了采用不同的陆地水储量估计方法得到的3组蒸散发值以外，另选择了4种常用的蒸散发模型来共同评估其不确定性。

> 收获：
>
> 由于序列越多越稳健，有如下两种想法：
>
> 1. 3种WB估计方法得到的年ET+两个模型最优结果+多模型模拟结果+多模型ET真实值
> 2. 两个最优变量驱动的2个模型结果+多模型ET真实值+其它单一再分析资料结果
>
> 实质：

### Data

| ET            | Description   | Date              |
| ------------- | ------------- | ----------------- |
| $ET_{REC}$    | reconstruct   |                   |
| $ET_{interp}$ | interp        |                   |
| $ET_{spline}$ | spline interp | 2003-2018, yearly |
| $ET_{CR}$     | CR model      |                   |
| $ET_{PML_V2}$ | PML_V2 model  |                   |

在每个盆地中，N（N=5）个不同的ET序列用$\{X_i\}~(i=1,2,3,...,N)$表示。每个序列可分为两部分：
$$
X_i=X_t+\epsilon_i,~i=1,2,...,N \tag1
$$

- $X_t$:  $ET$的真实值

- $\epsilon_i$: 第$i$个时间序列的噪声，该时间序列是一组与真信号正交的零均值白噪声

由于**真实参考场未知**，因此选择任意序列作为参考序列（$X_N$），剩余序列与参考序列之间的差异由以下公式定义：
$$
Y_{i,N} = X_i - X_N,~i = 1, 2, ..., N-1 \tag2
$$

- $Y_{i,N}$: 矩阵，**row**为时间

```
Y为time行model-1列矩阵
```



本研究中，使用$ET_{REC}$作为**参考序列**。$Y$的协方差矩阵可以表示为$S = cov(Y)$。然后引入$N \times N$的噪声协方差矩阵$R$。$R$矩阵是对角矩阵，**主对角元素**是每个序列**不确定性的平方**。$S$和$R$矩阵之间的关系表示为：
$$
S = J · R · J^T \tag3
$$
其中$J$是$(N-1) \times N$的矩阵，可表示为：
$$
J_{N-1,N} = 
\begin{bmatrix}
1 & 0 & \cdots & 0 & -1 \\
0 & 1 & \cdots & 0 & -1 \\
\vdots & \vdots & \ddots & \vdots & \vdots \\
0 & 0 & 0 & \cdots & -1 \\
\end{bmatrix} \tag4
$$
然而，**方程3**中的未知数数量为$N \times (N-1)/2$，而等式数量为$N \times (N-1)$。因此，这是一个**欠定方程组（underdetermined equation system）**，剩余的$N$个自由参数需要以合理的方式求解，以获得唯一解。Galindo等人提出了基于Kuhn-Tucker理论的目标函数和约束：
$$
F(r_{1N},...,r_{NN})=\frac{1}{K^2} \sum_{i<j}^{n} r_{ij}^2 \tag5
$$
其中，$K = \sqrt[N-1]{det(S)}$且$det(S)$表示$S$矩阵的行列式值。方程5的约束条件如下：
$$
H(r_{1N},...,r_{NN}) = - \frac{det(R)}{det(S)·K} < 0 \tag6
$$
为了使初始值满足约束，迭代计算的初始值设置为：
$$
r^{0}_{iN} = 0, i < N; r^{0}_{NN} = \frac{1}{2·S^*}, S^* = [1 \cdots 1]S^{-1}[1 \cdots 1]^T \tag7
$$
为了在约束条件下最小化目标函数，可以获得$N$个自由参数。然后可以求解$R$矩阵，**其主对角元素的平方根是每个序列的不确定性**。

GRACE数据在MRB流域的不确定性较高，这会导致TCH方法计算的七个序列的RMSE值出现偏差。因此，这些值不能代表MRB中四个模型的实际精度。我们根据**方程8**进一步评估了2个模型在$ET_{REC}$上的相对不确定性，公式如下：
$$
RU = \frac{RMSE_k}{\overline{E}},k = 1,2,...5 \tag{8}
$$

- $RU$: 相对不确定度relative uncertainty
- $\overline{E}$: $ET_{REC}$的平均值

















